# OSTEP 05 Process API

## 1. fork() 시스템 콜

현재 실행중인 프로세스의 복사본을 생성한다. 운영체제가 새로운 프로세스를 생성하고 이 새로운 프로세스는 원본 프로세스의 메모리 공간을 복사하여 가지게 된다.

부모 프로세스에는 새로 생성된 자식 프로세스의 PID를 반환하고, 자식 프로세스에는 0을 반환한다. 반환값이 다르기 때문에 부모, 자식 프로세스가 서로 다른 작업을 하도록 코드를 짤 수 있다.

## 2. wait() 시스템 콜

부모 프로세스가 자식 프로세스가 종료될 때까지 기다리게 하는 시스템 콜. 이 함수를 호출하면 부모 프로세스는 자식 프로세스가 종료될 때까지 블록된다. 자식 프로세스가 종료되면 운영 체제는 부모 프로세스에게 제어를 반환하고. 자식 프로세스의 종료 상태를 부모 프로세스에게 전달한다.

## 3. exex() 시스템 콜

현재 실행중인 프로세스의 메모리 공간을 새로운 프로그램으로 대체하는 시스템 콜. 이 함수를 호출하면 운영체제는 현재 프로세스의 메모리 공간을 세로운 프로그램으로 대체하고, 새로운 프로그램의 메인 함수를 실행한다. 자기 자신이 아닌 다른 프로그램을 실행해야 할 때 사용한다. exex() 함수가 성공하면 기존 프로그램은 리턴하지 않는다.

## 4. 왜 이런 API?

Unix의 쉘을 구현하기 위해서는 fork()와 exec()을 분리해야 한다. 그래야만 쉘이 fork() 를 호출하고 exec()를 호출하기 전에 코드를 실행할 수 있다

쉘은 프롬프트를 표시하고 사용자가 무언가 입력하기를 기다린다. 그리고 명령어를 입력한다. 대부분의 쉘은 파일 시스템에서 실행 파일의 위치를 찾고 명령어를 실행하기 위하여 fork()를 호출하여 새로운 자식 프로세스를 만든다. 그런 후 exec()의 변형 중 하나를 호출하여 프로그램을 실행시킨 후 wait()을 호출하여 명령어가 끝나기를 기다린다. 자식 프로세스가 종료되면 쉘은 wait()으로부터 리턴하고 다시 프롬프트를 출력하고 다음 명령어를 기다린다.

## 5. 기타 API

- kill() 시스템 콜은 프로세스에게 시그널을 보낸다. 시그널은 프로세스의 중단, 삭제 등의 작업에 사용된다. 시그널이라는 메커니즘은 외부 사건을 프로세스에게 전달하는 토대이다.
- ps 명령어는 어떤 프로세스가 실행중인지 알아보기 위해 사용된다.
- top 역시 시스템에 존재하는 프로세스와 그 프로세스가 cpu 및 다른 자원들을 얼마나 사용하고 있는지를 보여준다.

[[OSTEP 교재]] 참고
